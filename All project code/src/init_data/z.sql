INSERT INTO traffic (roomid, weekda, name, hr06, hr07, hr08, hr09, hr10, hr11, hr12, hr13, hr14, hr15, hr16, hr17, hr18, hr19, hr20, hr21, hr22, hr23, hr24)
SELECT roomid, weekda, name, AVG(CASE WHEN hr06 >= 0 THEN hr06 ELSE NULL END), AVG(CASE WHEN hr07 >= 0 THEN hr07 ELSE NULL END), AVG(CASE WHEN hr08 >= 0 THEN hr08 ELSE NULL END), AVG(CASE WHEN hr09 >= 0 THEN hr09 ELSE NULL END), AVG(CASE WHEN hr10 >= 0 THEN hr10 ELSE NULL END), AVG(CASE WHEN hr11 >= 0 THEN hr11 ELSE NULL END), AVG(CASE WHEN hr12 >= 0 THEN hr12 ELSE NULL END), AVG(CASE WHEN hr13 >= 0 THEN hr13 ELSE NULL END), AVG(CASE WHEN hr14 >= 0 THEN hr14 ELSE NULL END), AVG(CASE WHEN hr15 >= 0 THEN hr15 ELSE NULL END), AVG(CASE WHEN hr16 >= 0 THEN hr16 ELSE NULL END), AVG(CASE WHEN hr17 >= 0 THEN hr17 ELSE NULL END), AVG(CASE WHEN hr18 >= 0 THEN hr18 ELSE NULL END), AVG(CASE WHEN hr19 >= 0 THEN hr19 ELSE NULL END), AVG(CASE WHEN hr20 >= 0 THEN hr20 ELSE NULL END), AVG(CASE WHEN hr21 >= 0 THEN hr21 ELSE NULL END), AVG(CASE WHEN hr22 >= 0 THEN hr22 ELSE NULL END), AVG(CASE WHEN hr23 >= 0 THEN hr23 ELSE NULL END), AVG(CASE WHEN hr24 >= 0 THEN hr24 ELSE NULL END)
FROM traffic_day
GROUP BY roomid, weekda, name;
